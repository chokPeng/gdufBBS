package com.robben.bbs.controller;import com.robben.bbs.pojo.OrdinaryUser;import com.robben.bbs.service.OrdinaryUserService;import com.robben.bbs.util.ResultInfo;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.access.prepost.PreAuthorize;import org.springframework.security.core.context.SecurityContextHolder;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class OrdinaryUserController {    @Autowired    OrdinaryUserService ordinaryUserService;    @GetMapping("hello")    public UserDetails hello(OrdinaryUser user){        Object principal=                SecurityContextHolder.getContext().getAuthentication().getPrincipal();        if(principal instanceof UserDetails){            UserDetails userDetails=(UserDetails) principal;            System.out.println(userDetails.getPassword()+                    userDetails.getUsername()+userDetails.getAuthorities());            return  userDetails;        }        return  null;    }    @PostMapping("register")    public ResultInfo register(@RequestBody OrdinaryUser user){        return ResultInfo.success(ordinaryUserService.register(user));    }    @GetMapping("admin_root")    @PreAuthorize("hasRole('admin')")    public String test(){        return "I need admin root";    }    @GetMapping("user_role")    @PreAuthorize("hasRole('user') or hasRole('admin')")    public String userRoot(){        return "I need user root";    }}